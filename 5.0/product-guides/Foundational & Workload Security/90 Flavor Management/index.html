
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../images/isecl-logo.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.5.3">
    
    
      
        <title>Flavor Management - Intel® SecL-DC</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7a952b86.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Helvetica:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Helvetica";--md-code-font:"Fira Code"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="amber">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#flavor-management" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Intel® SecL-DC" class="md-header__button md-logo" aria-label="Intel® SecL-DC" data-md-component="logo">
      
  <img src="../../../images/isecl-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Intel® SecL-DC
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Flavor Management
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/intel-secl/intel-secl" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    intel-secl
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        Home
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../Intel%20Disclaimer/" class="md-tabs__link md-tabs__link--active">
        Product Guide
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../ReleaseNotes/ReleaseNotes/" class="md-tabs__link">
        Release Notes
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Intel® SecL-DC" class="md-nav__button md-logo" aria-label="Intel® SecL-DC" data-md-component="logo">
      
  <img src="../../../images/isecl-logo.png" alt="logo">

    </a>
    Intel® SecL-DC
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/intel-secl/intel-secl" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    intel-secl
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../..">Home</a>
          
        </div>
      
      <nav class="md-nav" aria-label="Home" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2">
          Product Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Product Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Product Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_1">
          Foundational and Workload Security
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Foundational and Workload Security" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Foundational and Workload Security
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Intel%20Disclaimer/" class="md-nav__link">
        Disclaimer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02%20Introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20%20Intel%C2%AE%20Security%20Libraries%20Components/" class="md-nav__link">
        Intel® Security Libraries Components
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../23%20Hardware%20Security%20Technology%20Considerations/" class="md-nav__link">
        Hardware Security Technology Considerations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../23.9%20Building%20the%20Intel%20SecL-DC%20Container%20Images/" class="md-nav__link">
        Building the Intel SecL-DC Container Images
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1_6" type="checkbox" id="__nav_2_1_6" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_1_6">
          Deploying Intel SecL-DC Using Helm
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Deploying Intel SecL-DC Using Helm" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_1_6">
          <span class="md-nav__icon md-icon"></span>
          Deploying Intel SecL-DC Using Helm
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../24%20Deploying%20Intel%20SecL%20using%20Helm/" class="md-nav__link">
        Deploying Intel SecL-DC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../25%20Deploying%20Intel%20SecL%20Use%20Cases%20Using%20Helm/" class="md-nav__link">
        Deploying Intel SecL Use Cases Using Helm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../25.12%20Installing%20the%20Workload%20Policy%20Manager/" class="md-nav__link">
        Installing the Workload Policy Manager
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../40%20Authentication/" class="md-nav__link">
        Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../50%20Connection%20Strings/" class="md-nav__link">
        Connection Strings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../59%20Endorsement%20Certificate%20Pre-Registration/" class="md-nav__link">
        Endorsement Certificate Pre-Registration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../60%20Platform%20Integrity%20Attestation/" class="md-nav__link">
        Platform Integrity Attestation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../65%20Trusted%20Workload%20Placement/" class="md-nav__link">
        Trusted Workload Placement
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../70%20Workload%20Confidentiality/" class="md-nav__link">
        Workload Confidentiality
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Flavor Management
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Flavor Management
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#flavor-format-definitions" class="md-nav__link">
    Flavor Format Definitions
  </a>
  
    <nav class="md-nav" aria-label="Flavor Format Definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#meta" class="md-nav__link">
    Meta
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardware" class="md-nav__link">
    Hardware
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pcr-banks-algorithms" class="md-nav__link">
    PCR banks (Algorithms)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pcrs" class="md-nav__link">
    PCRs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-platform-flavor" class="md-nav__link">
    Sample PLATFORM Flavor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-os-flavor" class="md-nav__link">
    Sample OS Flavor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-host_unique-flavor" class="md-nav__link">
    Sample HOST_UNIQUE Flavor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-asset_tag-flavor" class="md-nav__link">
    Sample ASSET_TAG Flavor
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flavor-templates" class="md-nav__link">
    Flavor Templates
  </a>
  
    <nav class="md-nav" aria-label="Flavor Templates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample-flavor-template" class="md-nav__link">
    Sample Flavor Template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flavor-template-definitions" class="md-nav__link">
    Flavor Template Definitions
  </a>
  
    <nav class="md-nav" aria-label="Flavor Template Definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#conditions" class="md-nav__link">
    Conditions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flavor-parts" class="md-nav__link">
    Flavor Parts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pcr-rules" class="md-nav__link">
    PCR Rules
  </a>
  
    <nav class="md-nav" aria-label="PCR Rules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pcr_matches" class="md-nav__link">
    pcr_matches
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventlog_includes" class="md-nav__link">
    eventlog_includes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excluding_tags" class="md-nav__link">
    excluding_tags
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flavor-matching" class="md-nav__link">
    Flavor Matching
  </a>
  
    <nav class="md-nav" aria-label="Flavor Matching">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#when-does-flavor-matching-happen" class="md-nav__link">
    When Does Flavor Matching Happen?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flavor-matching-performance" class="md-nav__link">
    Flavor Matching Performance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flavor-groups" class="md-nav__link">
    Flavor Groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-flavor-group" class="md-nav__link">
    Default Flavor Group
  </a>
  
    <nav class="md-nav" aria-label="Default Flavor Group">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic" class="md-nav__link">
    automatic
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unique" class="md-nav__link">
    unique
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flavor-match-policies" class="md-nav__link">
    Flavor Match Policies
  </a>
  
    <nav class="md-nav" aria-label="Flavor Match Policies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default-flavor-match-policy" class="md-nav__link">
    Default Flavor Match Policy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#any_of" class="md-nav__link">
    ANY_OF
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#all_of" class="md-nav__link">
    ALL_OF
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#latest" class="md-nav__link">
    LATEST
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#required" class="md-nav__link">
    REQUIRED
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#required_if_defined" class="md-nav__link">
    REQUIRED_IF_DEFINED
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flavor-match-event-triggers" class="md-nav__link">
    Flavor Match Event Triggers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-flavorgroup-api-calls" class="md-nav__link">
    Sample Flavorgroup API Calls
  </a>
  
    <nav class="md-nav" aria-label="Sample Flavorgroup API Calls">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-a-new-flavorgroup" class="md-nav__link">
    Create a New Flavorgroup
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ima-flavor" class="md-nav__link">
    IMA Flavor
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../100%20Scalability%20and%20Sizing/" class="md-nav__link">
        Scalability and Sizing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../105%20Deploying%20Individual%20Services%20Using%20Helm/" class="md-nav__link">
        Deploying Individual Services Using Helm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../106%20Helm%20charts%20Cleanup/" class="md-nav__link">
        Steps for Helm chart Cleanup
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1_17" type="checkbox" id="__nav_2_1_17" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_1_17">
          Intel Security Libraries Configuration Settings
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Intel Security Libraries Configuration Settings" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_1_17">
          <span class="md-nav__icon md-icon"></span>
          Intel Security Libraries Configuration Settings
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../110.0%20Changing%20Configuration%20Settings/" class="md-nav__link">
        Changing Configuration Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../110.3%20HVS%20Setup%20Task%20and%20Configuration%20Settings/" class="md-nav__link">
        Verification Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../110.6%20Trust%20Agent%20Setup%20Task%20and%20Configuration%20Settings/" class="md-nav__link">
        Trust Agent
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../110.9%20Integration%20Hub%20Setup%20Task%20and%20Configuration%20Settings/" class="md-nav__link">
        Integration Hub
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../110.1%20CMS%20Setup%20Task%20and%20Configuration%20Settings/" class="md-nav__link">
        Certificate Management Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../110.2%20AAS%20Setup%20Task%20and%20Configuration%20Settings/" class="md-nav__link">
        Authentication and Authorization Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../110.4%20WLS%20Setup%20Task%20and%20Configuration%20Settings/" class="md-nav__link">
        Workload Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../110.5%20KBS%20Setup%20Task%20and%20Configuration%20Settings/" class="md-nav__link">
        Key Broker Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../110.7%20Workload%20Agent%20Setup%20Task%20and%20Configuration%20Settings/" class="md-nav__link">
        Workload Agent
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../110.8%20WPM%20Setup%20Task%20and%20%20Configuration%20Settings/" class="md-nav__link">
        Workload Policy Manager
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../120%20Certificate%20and%20Key%20Management/" class="md-nav__link">
        Certificate and Key Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../130%20Upgrades/" class="md-nav__link">
        Upgrades
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../999%20Appendix/" class="md-nav__link">
        Appendix
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          Release Notes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Release Notes" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Release Notes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ReleaseNotes/ReleaseNotes/" class="md-nav__link">
        Intel Security Libraries for Data Center
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#flavor-format-definitions" class="md-nav__link">
    Flavor Format Definitions
  </a>
  
    <nav class="md-nav" aria-label="Flavor Format Definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#meta" class="md-nav__link">
    Meta
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardware" class="md-nav__link">
    Hardware
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pcr-banks-algorithms" class="md-nav__link">
    PCR banks (Algorithms)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pcrs" class="md-nav__link">
    PCRs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-platform-flavor" class="md-nav__link">
    Sample PLATFORM Flavor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-os-flavor" class="md-nav__link">
    Sample OS Flavor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-host_unique-flavor" class="md-nav__link">
    Sample HOST_UNIQUE Flavor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-asset_tag-flavor" class="md-nav__link">
    Sample ASSET_TAG Flavor
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flavor-templates" class="md-nav__link">
    Flavor Templates
  </a>
  
    <nav class="md-nav" aria-label="Flavor Templates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample-flavor-template" class="md-nav__link">
    Sample Flavor Template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flavor-template-definitions" class="md-nav__link">
    Flavor Template Definitions
  </a>
  
    <nav class="md-nav" aria-label="Flavor Template Definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#conditions" class="md-nav__link">
    Conditions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flavor-parts" class="md-nav__link">
    Flavor Parts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pcr-rules" class="md-nav__link">
    PCR Rules
  </a>
  
    <nav class="md-nav" aria-label="PCR Rules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pcr_matches" class="md-nav__link">
    pcr_matches
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eventlog_includes" class="md-nav__link">
    eventlog_includes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excluding_tags" class="md-nav__link">
    excluding_tags
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flavor-matching" class="md-nav__link">
    Flavor Matching
  </a>
  
    <nav class="md-nav" aria-label="Flavor Matching">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#when-does-flavor-matching-happen" class="md-nav__link">
    When Does Flavor Matching Happen?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flavor-matching-performance" class="md-nav__link">
    Flavor Matching Performance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flavor-groups" class="md-nav__link">
    Flavor Groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-flavor-group" class="md-nav__link">
    Default Flavor Group
  </a>
  
    <nav class="md-nav" aria-label="Default Flavor Group">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic" class="md-nav__link">
    automatic
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unique" class="md-nav__link">
    unique
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flavor-match-policies" class="md-nav__link">
    Flavor Match Policies
  </a>
  
    <nav class="md-nav" aria-label="Flavor Match Policies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default-flavor-match-policy" class="md-nav__link">
    Default Flavor Match Policy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#any_of" class="md-nav__link">
    ANY_OF
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#all_of" class="md-nav__link">
    ALL_OF
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#latest" class="md-nav__link">
    LATEST
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#required" class="md-nav__link">
    REQUIRED
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#required_if_defined" class="md-nav__link">
    REQUIRED_IF_DEFINED
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flavor-match-event-triggers" class="md-nav__link">
    Flavor Match Event Triggers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-flavorgroup-api-calls" class="md-nav__link">
    Sample Flavorgroup API Calls
  </a>
  
    <nav class="md-nav" aria-label="Sample Flavorgroup API Calls">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-a-new-flavorgroup" class="md-nav__link">
    Create a New Flavorgroup
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ima-flavor" class="md-nav__link">
    IMA Flavor
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/intel-secl/intel-secl/edit/master/docs/product-guides/Foundational & Workload Security/90 Flavor Management.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="flavor-management">Flavor Management</h1>
<p>===================</p>
<h2 id="flavor-format-definitions">Flavor Format Definitions</h2>
<hr />
<p>A Flavor is a standardized set of expectations that determines what
platform measurements will be considered “trusted.” Flavors are
constructed in a specific format, containing a metadata section
describing the Flavor, and then various other sections depending on the
Flavor type or Flavor part.</p>
<h3 id="meta">Meta</h3>
<p>The first part of a Flavor is the <code>meta</code> section:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&quot;meta&quot;</span><span class="p">:{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;vendor&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INTEL&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;flavor_part&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PLATFORM&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;bios_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Intel Corporation&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;bios_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SE5C620.86B.00.01.0004.071220170215&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;tpm_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2.0&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>This section defines the Flavor part and any versioning information.</p>
<details class="note" open="open">
<summary>Note</summary>
<p>Even when the BIOS or OS version remains the same, the actual measurements in the measured boot process will be different between TPM 1.2 and TPM 2.0, and so the TPM version is captured here as well. The attributes in the Meta section are used by the Flavor matching engine when matching Flavors to Hosts.  Note that TPM 1.2 is supported only for VMware ESXi hosts.</p>
</details>
<h3 id="hardware">Hardware</h3>
<p>The <code>hardware</code> section is unique to PLATFORM flavor parts:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&quot;hardware&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;processor_info&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;54 06 05 00 FF FB EB BF&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;processor_flags&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fpu vme de …&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;feature&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;tpm&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;pcr_banks&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                </span><span class="s2">&quot;SHA1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="s2">&quot;SHA256&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">]</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;txt&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>This part of the Flavor defines expected hardware attributes of the
host, and contains processor and TPM-related attributes.</p>
<h3 id="pcr-banks-algorithms">PCR banks (Algorithms)</h3>
<p>TPMs can have one or more PCR banks enabled with different hash algorithms.  Intel SecL will always attempt to use the most secure algorithm available in the enabled PCR banks.</p>
<p>For example, if a given TPM has the following PCR banks enabled:</p>
<div class="highlight"><pre><span></span><code>SHA1
SHA256
SHA384
</code></pre></div>
<p>The HVS will prefer the SHA384 PCR bank when creating flavors and performing attestations.  </p>
<p>The TPM vendor and version, platform OEM, and BIOS version and configuration each impact which PCR banks can potentially be enabled.  Some manufacturers will allow users to configure which banks are enabled/disabled in the BIOS.  Other manufacturers will enable only one PCR bank, and others will be permanently disabled.</p>
<p>Flavors will only utilize a single PCR bank, and when importing from a sample host the HVS will always prefer the strongest algorithm supported by the enabled TPM PCR banks.  In the above example, a flavor imported from that host would use the SHA384 bank for all hash values.  This means that all hosts that will be attested using this flavor must also have SHA284 banks enabled in their TPMs.</p>
<p>Typically, among otherwise-identical servers this will not be an issue.  However, in a mixed environment it can be possible to have an OS flavor, for example, that needs to apply for some hosts that have SHA384 banks enabled, and other servers that only have SHA256 enabled and do not support SHA384.</p>
<p>In this circumstance, multiple flavors for the same OS version would need to be created - one for SHA384, and another for SHA256.</p>
<h3 id="pcrs">PCRs</h3>
<p>The last section of a Flavor is the “PCRs” section, which contains the
actual expected measurements for any PCRs. This section will contain PCR
measurements for each applicable algorithm supported by the TPM (SHA1
only for TPM 1.2, SHA256 and SHA1 sections for TPM 2.0).</p>
<p>Some PCRs simply have a value and nothing else. Other PCRs, however,
contain different <code>event</code> measurements. This indicates that separate
individual platform or OS components are independently measured and
extended to the same PCR. PCRs with event measurements will contain an
<code>Event</code> array that lists, in the correct order, all of the events in the
measurement event log that are extended to this PCR. When the
Verification Service attests a host against a given Flavor, each
measurement event is compared to the Flavor value, and all of the events
are replayed to confirm that a replay of all of the measurement
extensions do in fact result in the hash seen in the PCR value. In this
way, the Verification Service can ensure that the measurement event log
contents are secure, and the individual measurements can be attested so
that the cause for an Untrusted attestation can easily be seen.</p>
<p>The full PCRs section is not shown here due to length; see the sample
Flavor sections for a full sample.</p>
<div class="highlight"><pre><span></span><code><span class="nt">&quot;pcrs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;SHA1&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;pcr_0&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;d2ed125942726641a7260c4f92beb67d531a0def&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;pcr_17&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1ec12004b371e3afd43d04155abde7476a3794fa&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;event&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2fb7d57dcc5455af9ac08d82bdf315dbcc59a044&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HASH_START&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HASH_START&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="p">},</span><span class="w"></span>
<span class="w">                </span><span class="err">...</span><span class="w"></span>
</code></pre></div>
<h3 id="sample-platform-flavor">Sample PLATFORM Flavor</h3>
<p>The <code>PLATFORM</code> Flavor part encompasses measurements that are unique to a
specific platform, including the server OEM, BIOS version, etc. A
PLATFORM Flavor can be <code>shared</code> across all hosts of the same model that
have the same BIOS version.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;flavor_collection&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;flavors&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;meta&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;vendor&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INTEL&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;flavor_part&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot; PLATFORM&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;bios_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Intel Corporation&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;bios_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SE5C620.86B.00.01.0004.071220170215&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;tpm_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2.0&quot;</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="p">},</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;hardware&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;processor_info&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;54 06 05 00 FF FB EB BF&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;processor_flags&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fpu vme de …&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;feature&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;tpm&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;pcr_banks&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                                </span><span class="s2">&quot;SHA1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="s2">&quot;SHA256&quot;</span><span class="w"></span>
<span class="w">                            </span><span class="p">]</span><span class="w"></span>
<span class="w">                        </span><span class="p">},</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;txt&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"></span>
<span class="w">                        </span><span class="p">}</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="p">},</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;pcrs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;SHA1&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;pcr_0&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;d2ed125942726641a7260c4f92beb67d531a0def&quot;</span><span class="w"></span>
<span class="w">                        </span><span class="p">},</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;pcr_17&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1ec12004b371e3afd43d04155abde7476a3794fa&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;event&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2fb7d57dcc5455af9ac08d82bdf315dbcc59a044&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HASH_START&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HASH_START&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ffb1806465d2de1b7531fd5a2a6effaad7c5a047&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;BIOSAC_REG_DATA&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;BIOSAC_REG_DATA&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;3c585604e87f855973731fea83e21fab9392d2fc&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CPU_SCRTM_STAT&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CPU_SCRTM_STAT&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;9069ca78e7450a285173431b3e52c5c25299e473&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_CONTROL_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_CONTROL_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;5ba93c9db0cff93f52b521d7420e43f6eda2784f&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_DETAILS_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_DETAILS_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;5ba93c9db0cff93f52b521d7420e43f6eda2784f&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;STM_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;STM_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;3c585604e87f855973731fea83e21fab9392d2fc&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OSSINITDATA_CAP_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OSSINITDATA_CAP_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;3d42560dcf165a5557b3156a21583f2c6dbef10e&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MLE_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MLE_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;274f929dbab8b98a7031bbcd9ea5613c2a28e5e6&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;NV_INFO_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;NV_INFO_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ca96de412b4e8c062e570d3013d2fccb4b20250a&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tb_policy&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tb_policy&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;d123e2f2b30f1effa8d9522f667af0dac4f48cfb&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;vmlinuz&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;vmlinuz&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;f3742133e1a0deb48177a74ed225418e5cf73fd1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;initrd&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;initrd&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">}</span><span class="w"></span>
<span class="w">                            </span><span class="p">]</span><span class="w"></span>
<span class="w">                        </span><span class="p">}</span><span class="w"></span>
<span class="w">                    </span><span class="p">},</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;SHA256&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;pcr_0&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;db83f0e8a1773c21164c17986037cdf8afc1bbdc1b815772c6da1befb1a7f8a3&quot;</span><span class="w"></span>
<span class="w">                        </span><span class="p">},</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;pcr_17&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;50bd58407a1893056eacff493245cfe785f045b2c0e1cc3e6e9eb5812d8d91bd&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;event&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;9301981c093654d5aa3430ba05c880a52eb22b9e18248f5f93e1fe1dab1cb947&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HASH_START&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HASH_START&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2785d1ed65f6b5d4b555dc24ce5e068a44ce8740fe77e01e15a10b1ff66cca90&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;BIOSAC_REG_DATA&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;BIOSAC_REG_DATA&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;67abdd721024f0ff4e0b3f4c2fc13bc5bad42d0b7851d456d88d203d15aaa450&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CPU_SCRTM_STAT&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CPU_SCRTM_STAT&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;df3f619804a92fdb4057192dc43dd748ea778adc52bc498ce80524c014b81119&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_CONTROL_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_CONTROL_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">}</span><span class="w"></span>
<span class="w">                            </span><span class="p">]</span><span class="w"></span>
<span class="w">                        </span><span class="p">}</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<h3 id="sample-os-flavor">Sample OS Flavor</h3>
<p>An OS Flavor encompasses all of the measurements unique to a given OS.
This includes the OS kernel and other measurements.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;flavor_collection&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;flavors&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;meta&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;vendor&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INTEL&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;flavor_part&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OS&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;os_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;RedHatEnterpriseServer&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;os_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;7.3&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;vmm_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;vmm_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;tpm_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2.0&quot;</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="p">},</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;pcrs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;SHA1&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;pcr_17&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1ec12004b371e3afd43d04155abde7476a3794fa&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;event&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2fb7d57dcc5455af9ac08d82bdf315dbcc59a044&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HASH_START&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HASH_START&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ffb1806465d2de1b7531fd5a2a6effaad7c5a047&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;BIOSAC_REG_DATA&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;BIOSAC_REG_DATA&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;3c585604e87f855973731fea83e21fab9392d2fc&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CPU_SCRTM_STAT&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CPU_SCRTM_STAT&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;9069ca78e7450a285173431b3e52c5c25299e473&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_CONTROL_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_CONTROL_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;5ba93c9db0cff93f52b521d7420e43f6eda2784f&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_DETAILS_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_DETAILS_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;5ba93c9db0cff93f52b521d7420e43f6eda2784f&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;STM_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;STM_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;3c585604e87f855973731fea83e21fab9392d2fc&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OSSINITDATA_CAP_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OSSINITDATA_CAP_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;3d42560dcf165a5557b3156a21583f2c6dbef10e&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MLE_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MLE_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;274f929dbab8b98a7031bbcd9ea5613c2a28e5e6&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;NV_INFO_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;NV_INFO_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ca96de412b4e8c062e570d3013d2fccb4b20250a&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tb_policy&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tb_policy&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;d123e2f2b30f1effa8d9522f667af0dac4f48cfb&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;vmlinuz&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;vmlinuz&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;f3742133e1a0deb48177a74ed225418e5cf73fd1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;initrd&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;initrd&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">}</span><span class="w"></span>
<span class="w">                            </span><span class="p">]</span><span class="w"></span>
<span class="w">                        </span><span class="p">}</span><span class="w"></span>
<span class="w">                    </span><span class="p">},</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;SHA256&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;pcr_17&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;50bd58407a1893056eacff493245cfe785f045b2c0e1cc3e6e9eb5812d8d91bd&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;event&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;9301981c093654d5aa3430ba05c880a52eb22b9e18248f5f93e1fe1dab1cb947&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HASH_START&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HASH_START&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2785d1ed65f6b5d4b555dc24ce5e068a44ce8740fe77e01e15a10b1ff66cca90&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;BIOSAC_REG_DATA&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;BIOSAC_REG_DATA&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;67abdd721024f0ff4e0b3f4c2fc13bc5bad42d0b7851d456d88d203d15aaa450&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CPU_SCRTM_STAT&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CPU_SCRTM_STAT&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;df3f619804a92fdb4057192dc43dd748ea778adc52bc498ce80524c014b81119&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_CONTROL_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_CONTROL_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;6e340b9cffb37a989ca544e6bb780a2c78901d3fb33738768511a30617afa01d&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_DETAILS_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_DETAILS_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;6e340b9cffb37a989ca544e6bb780a2c78901d3fb33738768511a30617afa01d&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;STM_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;STM_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;67abdd721024f0ff4e0b3f4c2fc13bc5bad42d0b7851d456d88d203d15aaa450&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OSSINITDATA_CAP_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OSSINITDATA_CAP_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;26e1d98742f79c950dc637f8c067b0b72a1b0e8ff75db4e609c7e17321acf3f4&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MLE_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MLE_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0f6e0c7a5944963d7081ea494ddff1e9afa689e148e39f684db06578869ea38b&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;NV_INFO_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;NV_INFO_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;27808f64e6383982cd3bcc10cfcb3457c0b65f465f779d89b668839eaf263a67&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tb_policy&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tb_policy&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;c89ad1d1e9adaa7ecfee2abce763b92472685f7d1b9f3799bf49974b66ed9638&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;vmlinuz&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;vmlinuz&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">},</span><span class="w"></span>
<span class="w">                                </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;81b88e268e697ccf1790d41b9de748a8f395acfb47aa67c9845479d4e8456f77&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;initrd&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;initrd&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                                </span><span class="p">}</span><span class="w"></span>
<span class="w">                            </span><span class="p">]</span><span class="w"></span>
<span class="w">                        </span><span class="p">}</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;flavorgroup_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;automatic&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h3 id="sample-host_unique-flavor">Sample HOST_UNIQUE Flavor</h3>
<p>Host-Unique flavors define measurements for a specific host. This can be
either a single large flavor that incorporates all of the host
measurements into a single flavor document used only to attest a single
host, or can be a small subset of measurements that are specific to a
single host. For example, some VMWare module measurements will change
from one host to the next, while most others will be shared assuming the
same ESXi build is used. The full Flavor requirement for such a host
would include Host-Unique flavors to cover the measurements that are
unique to only this one host, and would still use a generic PLATFORM and
OS flavor for the other measurements that would be identical for other
similarly configured hosts.</p>
<details class="note" open="open">
<summary>Note</summary>
<p>The HOST_UNIQUE Flavors are unique to a specific host, and should always be imported directly from the specific host.</p>
</details>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;flavors&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;meta&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;4d387cbd-f72b-4742-b4e5-c5b0ffed59e0&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;vendor&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INTEL&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;flavor_part&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HOST_UNIQUE&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Purley11&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;bios_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Intel Corporation&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;bios_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SE5C620.86B.00.01.0004.071220170215&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;os_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;RedHatEnterpriseServer&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;os_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;7.4&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;tpm_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2.0&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;hardware_uuid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;00448C61-46F2-E711-906E-001560A04062&quot;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;pcrs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;SHA256&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;pcr_17&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;f9ef8c53ddfc8096d36eda5506436c52b4bfa2bd451a89aaa102f03181722176&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;event&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                            </span><span class="p">{</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;df3f619804a92fdb4057192dc43dd748ea778adc52bc498ce80524c014b81119&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_CONTROL_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_CONTROL_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                </span><span class="p">}</span><span class="w"></span>
<span class="w">                            </span><span class="p">},</span><span class="w"></span>
<span class="w">                            </span><span class="p">{</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;09f468dfc1d98a1fee86eb7297a56b0e097d57be66db4eae539061332da2e723&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;initrd&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;initrd&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                </span><span class="p">}</span><span class="w"></span>
<span class="w">                            </span><span class="p">}</span><span class="w"></span>
<span class="w">                        </span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="p">},</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;pcr_18&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;c1f7bfdae5f270d9f13aa9620b8977951d6b759f1131fe9f9289317f3a56efa1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;event&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                            </span><span class="p">{</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;df3f619804a92fdb4057192dc43dd748ea778adc52bc498ce80524c014b81119&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_CONTROL_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_CONTROL_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                </span><span class="p">}</span><span class="w"></span>
<span class="w">                            </span><span class="p">}</span><span class="w"></span>
<span class="w">                        </span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="p">},</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;SHA1&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;pcr_17&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;48695f747a3d494710bd14d20cb0a93c78a485cc&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;event&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                            </span><span class="p">{</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;9069ca78e7450a285173431b3e52c5c25299e473&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_CONTROL_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_CONTROL_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                </span><span class="p">}</span><span class="w"></span>
<span class="w">                            </span><span class="p">},</span><span class="w"></span>
<span class="w">                            </span><span class="p">{</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;b1f8db372e396bb128280821b7e0ac54a5ec2791&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;initrd&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;initrd&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                </span><span class="p">}</span><span class="w"></span>
<span class="w">                            </span><span class="p">}</span><span class="w"></span>
<span class="w">                        </span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="p">},</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;pcr_18&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;983ec7db975ed31e2c85ef8e375c038d6d307efb&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;event&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                            </span><span class="p">{</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;digest_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.intel.mtwilson.lib.common.model.MeasurementSha1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;9069ca78e7450a285173431b3e52c5c25299e473&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_CONTROL_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;ComponentName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LCP_CONTROL_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="nt">&quot;EventName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OpenSource.EventName&quot;</span><span class="w"></span>
<span class="w">                                </span><span class="p">}</span><span class="w"></span>
<span class="w">                            </span><span class="p">}</span><span class="w"></span>
<span class="w">                        </span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h3 id="sample-asset_tag-flavor">Sample ASSET_TAG Flavor</h3>
<p>Asset Tag flavor parts are unique to Asset Tag attestation. These
flavors verify that the Asset Tag data in the host’s TPM correctly
matches the most recently created, currently valid Asset Tag certificate
that has been deployed to that host.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;meta&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;b3e0c056-5b6c-4b6b-95c4-de5f1473cac0&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;flavor_part&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ASSET_TAG&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;hardware_uuid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;Hardware UUID of the server to be tagged&gt;&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;external&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;asset_tag&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;tag_certificate&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;encoded&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;Tag certificate in base64 encoded format&gt;&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;issuer&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CN=assetTagService&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;serial_number&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1519153541461</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;subject&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;Hardware UUID of the server to be tagged&gt;&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;not_before&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2018-02-20T11:05:41-0800&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;not_after&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2019-02-20T11:05:41-0800&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;fingerprint_sha384&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;46001d8472e56de423aac7c55f061404d27d50e497dfc21a861ef1965d7ac1e44887aee918fb5805385a3cbdf820899d&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;attribute&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                    </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;attr_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2.5.4.789.2&quot;</span><span class="w"></span>
<span class="w">                        </span><span class="p">},</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;attribute_values&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                            </span><span class="p">{</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;objects&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">                            </span><span class="p">}</span><span class="w"></span>
<span class="w">                        </span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="p">},</span><span class="w"></span>
<span class="w">                    </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;attr_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2.5.4.789.2&quot;</span><span class="w"></span>
<span class="w">                        </span><span class="p">},</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;attribute_values&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                            </span><span class="p">{</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;objects&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">                            </span><span class="p">}</span><span class="w"></span>
<span class="w">                        </span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="p">},</span><span class="w"></span>
<span class="w">                    </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;attr_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2.5.4.789.2&quot;</span><span class="w"></span>
<span class="w">                        </span><span class="p">},</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;attribute_values&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                            </span><span class="p">{</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;objects&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">                            </span><span class="p">}</span><span class="w"></span>
<span class="w">                        </span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="p">]</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h2 id="flavor-templates">Flavor Templates</h2>
<p>Added in the Intel SecL-DC 4.0 release, Flavor Templates expose the backend logic that determines which PCRs and event log measurements will be used for specific Flavor parts.  Where previously these rules were hardcoded on the backend, this new feature allows new templates to be added, and allows the customization or deletion of existing templates to suit specific business needs.</p>
<p>Flavor Templates are conditional rules that apply to a Flavor part cumulatively based on defined conditions.  For example a PLATFORM Flavor for a Linux host with Intel TXT enabled would normally include PCR0. If tboot is also enabled, elements from PCR 17 and 18 will be added to the PLATFORM flavor.  These are cumulative based on which conditions are true on a given host.</p>
<p>By default, Flavor Templates will come pre-populated in the HVS database to meet the same default behavior for previous releases.  </p>
<p>Flavor Templates can be added, removed, or edited to create customized rules.  For example, if there is a specific event log measurement that a user would like to add to an OS flavor, a new Flavor Template can be added for the OS Flavor part that defines a condition for applying the Template, along with the specific event log measurement that should be used when that condition is satisfied.</p>
<p>Flavor Templates are cumulative.  If a given host matches all of the conditions defined for Flavor Template A and Flavor Template B, both Templates will be applied when importing Flavors from that host.</p>
<h3 id="sample-flavor-template">Sample Flavor Template</h3>
<p>Below is a sample default Flavor Template used for RedHat Enterprise Linux servers with TPM2.0 and tboot enabled:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;8798fb0c-2dfa-4464-8281-e650a30da7e6&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="s2">&quot;default-linux-rhel-tpm20-tboot&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="nt">&quot;condition&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;//host_info/os_name//*[text()=&#39;RedHatEnterprise&#39;]&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;//host_info/hardware_features/TPM/meta/tpm_version//*[text()=&#39;2.0&#39;]&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;//host_info/tboot_installed//*[text()=&#39;true&#39;]&quot;</span><span class="w"></span>
<span class="w">   </span><span class="p">],</span><span class="w"></span>
<span class="w">   </span><span class="nt">&quot;flavor_parts&quot;</span><span class="p">:{</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;OS&quot;</span><span class="p">:{</span><span class="w"></span>
<span class="w">         </span><span class="nt">&quot;meta&quot;</span><span class="p">:{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;tpm_version&quot;</span><span class="p">:</span><span class="s2">&quot;2.0&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;tboot_installed&quot;</span><span class="p">:</span><span class="kc">true</span><span class="w"></span>
<span class="w">         </span><span class="p">},</span><span class="w"></span>
<span class="w">         </span><span class="nt">&quot;pcr_rules&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">               </span><span class="nt">&quot;pcr&quot;</span><span class="p">:{</span><span class="w"></span>
<span class="w">                  </span><span class="nt">&quot;bank&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA384&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA1&quot;</span><span class="w"></span>
<span class="w">                  </span><span class="p">],</span><span class="w"></span>
<span class="w">                  </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="mi">17</span><span class="w"></span>
<span class="w">               </span><span class="p">},</span><span class="w"></span>
<span class="w">               </span><span class="nt">&quot;eventlog_includes&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">                  </span><span class="s2">&quot;vmlinuz&quot;</span><span class="w"></span>
<span class="w">               </span><span class="p">]</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">         </span><span class="p">]</span><span class="w"></span>
<span class="w">      </span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;PLATFORM&quot;</span><span class="p">:{</span><span class="w"></span>
<span class="w">         </span><span class="nt">&quot;meta&quot;</span><span class="p">:{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;tpm_version&quot;</span><span class="p">:</span><span class="s2">&quot;2.0&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;tboot_installed&quot;</span><span class="p">:</span><span class="kc">true</span><span class="w"></span>
<span class="w">         </span><span class="p">},</span><span class="w"></span>
<span class="w">         </span><span class="nt">&quot;pcr_rules&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">               </span><span class="nt">&quot;pcr&quot;</span><span class="p">:{</span><span class="w"></span>
<span class="w">                  </span><span class="nt">&quot;bank&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA384&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA1&quot;</span><span class="w"></span>
<span class="w">                  </span><span class="p">],</span><span class="w"></span>
<span class="w">                  </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="mi">0</span><span class="w"></span>
<span class="w">               </span><span class="p">},</span><span class="w"></span>
<span class="w">               </span><span class="nt">&quot;pcr_matches&quot;</span><span class="p">:</span><span class="kc">true</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">               </span><span class="nt">&quot;pcr&quot;</span><span class="p">:{</span><span class="w"></span>
<span class="w">                  </span><span class="nt">&quot;bank&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA384&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA1&quot;</span><span class="w"></span>
<span class="w">                  </span><span class="p">],</span><span class="w"></span>
<span class="w">                  </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="mi">17</span><span class="w"></span>
<span class="w">               </span><span class="p">},</span><span class="w"></span>
<span class="w">               </span><span class="nt">&quot;eventlog_equals&quot;</span><span class="p">:{</span><span class="w"></span>
<span class="w">                  </span><span class="nt">&quot;excluding_tags&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;LCP_CONTROL_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;initrd&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;vmlinuz&quot;</span><span class="w"></span>
<span class="w">                  </span><span class="p">]</span><span class="w"></span>
<span class="w">               </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">               </span><span class="nt">&quot;pcr&quot;</span><span class="p">:{</span><span class="w"></span>
<span class="w">                  </span><span class="nt">&quot;bank&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA384&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA1&quot;</span><span class="w"></span>
<span class="w">                  </span><span class="p">],</span><span class="w"></span>
<span class="w">                  </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="mi">18</span><span class="w"></span>
<span class="w">               </span><span class="p">},</span><span class="w"></span>
<span class="w">               </span><span class="nt">&quot;eventlog_equals&quot;</span><span class="p">:{</span><span class="w"></span>
<span class="w">                  </span><span class="nt">&quot;excluding_tags&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;LCP_CONTROL_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;initrd&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;vmlinuz&quot;</span><span class="w"></span>
<span class="w">                  </span><span class="p">]</span><span class="w"></span>
<span class="w">               </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">         </span><span class="p">]</span><span class="w"></span>
<span class="w">      </span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;HOST_UNIQUE&quot;</span><span class="p">:{</span><span class="w"></span>
<span class="w">         </span><span class="nt">&quot;meta&quot;</span><span class="p">:{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;tpm_version&quot;</span><span class="p">:</span><span class="s2">&quot;2.0&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;tboot_installed&quot;</span><span class="p">:</span><span class="kc">true</span><span class="w"></span>
<span class="w">         </span><span class="p">},</span><span class="w"></span>
<span class="w">         </span><span class="nt">&quot;pcr_rules&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">               </span><span class="nt">&quot;pcr&quot;</span><span class="p">:{</span><span class="w"></span>
<span class="w">                  </span><span class="nt">&quot;bank&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA384&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA1&quot;</span><span class="w"></span>
<span class="w">                  </span><span class="p">],</span><span class="w"></span>
<span class="w">                  </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="mi">17</span><span class="w"></span>
<span class="w">               </span><span class="p">},</span><span class="w"></span>
<span class="w">               </span><span class="nt">&quot;eventlog_includes&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">                  </span><span class="s2">&quot;LCP_CONTROL_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="s2">&quot;initrd&quot;</span><span class="w"></span>
<span class="w">               </span><span class="p">]</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">               </span><span class="nt">&quot;pcr&quot;</span><span class="p">:{</span><span class="w"></span>
<span class="w">                  </span><span class="nt">&quot;bank&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA384&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA1&quot;</span><span class="w"></span>
<span class="w">                  </span><span class="p">],</span><span class="w"></span>
<span class="w">                  </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="mi">18</span><span class="w"></span>
<span class="w">               </span><span class="p">},</span><span class="w"></span>
<span class="w">               </span><span class="nt">&quot;eventlog_includes&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">                  </span><span class="s2">&quot;LCP_CONTROL_HASH&quot;</span><span class="w"></span>
<span class="w">               </span><span class="p">]</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">         </span><span class="p">]</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h3 id="flavor-template-definitions">Flavor Template Definitions</h3>
<p>A Flavor Template consists of several sections:</p>
<p>The "id" and "label" keys are unique identifiers.  The ID is generated automatically by the HVS when the Template is created; the label is user-specified and must be unique.</p>
<h4 id="conditions">Conditions</h4>
<p>The "condition" section contains a map of host-info elements to match when deciding to apply the Template.  For example:</p>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="nt">&quot;condition&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;//host_info/os_name//*[text()=&#39;RedHatEnterprise&#39;]&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;//host_info/hardware_features/TPM/meta/tpm_version//*[text()=&#39;2.0&#39;]&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="s2">&quot;//host_info/tboot_installed//*[text()=&#39;true&#39;]&quot;</span><span class="w"></span>
<span class="w">   </span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<p>This sample contains three conditions, each of which must be true for this Template to apply:</p>
<p>os_name: 'RedHatEnterprise'</p>
<p>tpm_version: 2.0</p>
<p>tboot_installed: true</p>
<p>This will apply for RedHat hosts with TPM2.0 and tboot enabled.  If a Flavor is imported from a VMware ESXi host, this template will not apply.  The condition paths directly refer to host-info elements collected from the host.  The full host-info details for a host can be viewed using the /hvs/v2/host-status API; below is a snippet of the host-info section (note that additional host-info elements may be added as new platform features are incorporated):</p>
<div class="highlight"><pre><span></span><code><span class="w">               </span><span class="nt">&quot;host_info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;os_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;RedHatEnterprise&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;os_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;8.4&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;os_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;linux&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;bios_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SE11111.111.11.11.1111.11111111111&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;vmm_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;vmm_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;processor_info&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;54 06 05 00 FF FB EB BF&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;host_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hostname&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;bios_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Intel Corporation&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;hardware_uuid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;UUID&gt;&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;process_flags&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;FPU VME DE PSE TSC MSR PAE MCE CX8 APIC SEP MTRR PGE MCA CMOV PAT PSE-36 CLFSH DS ACPI MMX FXSR SSE SSE2 SS HTT TM PBE&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;no_of_sockets&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;72&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;tboot_installed&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;false&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;is_docker_env&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;false&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;hardware_features&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;TXT&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;true&quot;</span><span class="w"></span>
<span class="w">                        </span><span class="p">},</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;TPM&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;meta&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;tpm_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2.0&quot;</span><span class="w"></span>
<span class="w">                            </span><span class="p">}</span><span class="w"></span>
<span class="w">                        </span><span class="p">},</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;CBNT&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;false&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;meta&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;profile&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;msr&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"></span>
<span class="w">                            </span><span class="p">}</span><span class="w"></span>
<span class="w">                        </span><span class="p">},</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;UEFI&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;false&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;meta&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                </span><span class="nt">&quot;secure_boot_enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"></span>
<span class="w">                            </span><span class="p">}</span><span class="w"></span>
<span class="w">                        </span><span class="p">}</span><span class="w"></span>
<span class="w">                    </span><span class="p">},</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;installed_components&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                        </span><span class="s2">&quot;tagent&quot;</span><span class="w"></span>
<span class="w">                    </span><span class="p">]</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<h4 id="flavor-parts">Flavor Parts</h4>
<p>This section of the template will define behaviors for each Flavor part.  Each different Flavor part is optional; if the new Template will only affect the OS Flavor part, only the OS Flavor part needs to be defined here.  Each Flavor part specified will have its own "meta" section where conditional host attributes will be defined.  These must match with host-info attributes; for example, in the sample above the OS part uses the following "meta" section elements:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nt">&quot;tpm_version&quot;</span><span class="p">:</span><span class="s2">&quot;2.0&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nt">&quot;tboot_installed&quot;</span><span class="p">:</span><span class="kc">true</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>These directly correspond to host-info elements from the hosts this Template will apply to.</p>
<h4 id="pcr-rules">PCR Rules</h4>
<p>Each Flavor part section of a Flavor Template may contain 0 or more PCR rules that define PCRs to include.  Again using the OS Flavor part example from above, the default Template defines SHA1, SHA256, or SHA384 PCR banks; this tells the HVS to use the "best" available PCR bank algorithm, but that each of these algorithms is acceptable.  Alternatively, if the Template listed only the SHA384 PCR bank, the resulting Flavor would <em>require</em> the SHA384 PCR bank and would disregard any SHA256 or SHA1 banks, even if the SHA384 bank is unavailable and the SHA256 bank is enabled on the server.</p>
<p>The PCR Rules will also contain at least one PCR index, indicating which PCR the rule applies to.</p>
<h5 id="pcr_matches">pcr_matches</h5>
<p>PCRs can require a direct PCR value match (when event logs are unnecessary and the final PCR hash is required to match a specific value), and/or can contain event log include/exclude/equals rules.</p>
<p>A direct PCR value match requirement is the easiest definitions, but should only be used when a specific PCR is known to always be the same on all hosts that the resulting Flavor will apply to:</p>
<div class="highlight"><pre><span></span><code><span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">               </span><span class="nt">&quot;pcr&quot;</span><span class="p">:{</span><span class="w"></span>
<span class="w">                  </span><span class="nt">&quot;bank&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA384&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA1&quot;</span><span class="w"></span>
<span class="w">                  </span><span class="p">],</span><span class="w"></span>
<span class="w">                  </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="mi">0</span><span class="w"></span>
<span class="w">               </span><span class="p">},</span><span class="w"></span>
<span class="w">               </span><span class="nt">&quot;pcr_matches&quot;</span><span class="p">:</span><span class="kc">true</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>This requires the value of PCR0 to exactly match, and will not examine specific event log details for this PCR index.</p>
<h5 id="eventlog_includes">eventlog_includes</h5>
<p>The following example shows how to require a specific event log entry to exist:</p>
<div class="highlight"><pre><span></span><code><span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">               </span><span class="nt">&quot;pcr&quot;</span><span class="p">:{</span><span class="w"></span>
<span class="w">                  </span><span class="nt">&quot;bank&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA384&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA1&quot;</span><span class="w"></span>
<span class="w">                  </span><span class="p">],</span><span class="w"></span>
<span class="w">                  </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="mi">17</span><span class="w"></span>
<span class="w">               </span><span class="p">},</span><span class="w"></span>
<span class="w">               </span><span class="nt">&quot;eventlog_includes&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">                  </span><span class="s2">&quot;vmlinuz&quot;</span><span class="w"></span>
<span class="w">               </span><span class="p">]</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>This rule will require the "vmlinuz" event log measurement to be present in the PCR17 event log.</p>
<h5 id="excluding_tags">excluding_tags</h5>
<p>Specific event logs can also be excluded; in the below example, all events from PCR17 will be part of the resulting Flavor, but will exclude the LCP_CONTROL_HASH, initrd, and vmlinuz measurement events specifically.  This is often used when a specific PCR contains measurements that should apply to different Flavor parts; different rules need to be defined to ensure that the correct events are included in the right Flavor part, and events that will apply for different Flavor parts must be excluded.</p>
<div class="highlight"><pre><span></span><code><span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">               </span><span class="nt">&quot;pcr&quot;</span><span class="p">:{</span><span class="w"></span>
<span class="w">                  </span><span class="nt">&quot;bank&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA384&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA256&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;SHA1&quot;</span><span class="w"></span>
<span class="w">                  </span><span class="p">],</span><span class="w"></span>
<span class="w">                  </span><span class="nt">&quot;index&quot;</span><span class="p">:</span><span class="mi">17</span><span class="w"></span>
<span class="w">               </span><span class="p">},</span><span class="w"></span>
<span class="w">               </span><span class="nt">&quot;eventlog_equals&quot;</span><span class="p">:{</span><span class="w"></span>
<span class="w">                  </span><span class="nt">&quot;excluding_tags&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;LCP_CONTROL_HASH&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;initrd&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="s2">&quot;vmlinuz&quot;</span><span class="w"></span>
<span class="w">                  </span><span class="p">]</span><span class="w"></span>
<span class="w">               </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<h2 id="flavor-matching">Flavor Matching</h2>
<hr />
<p>Flavors are matched to host by objects called <code>Flavor Groups</code> A Flavor
Group represents a set of rules to satisfy for a set of flavors to be
matched to a host for attestation. For example, a Flavor Group can
require that a <code>PLATFORM</code> Flavor and an <code>OS</code> Flavor be used for attestation.
Without this level of association, a host that matches measurements for
only a <code>PLATFORM</code> flavor, for example, can be attested as Trusted, even
though the OS Flavor would attest the host as Untrusted.</p>
<p>Flavor matching can be automatic (the default), or can explicitly
specify a host to which the Flavor Group must apply.</p>
<p>Automatic flavor matching allows for more ease in datacenter lifecycle
management with updates and patches that may cause the appropriate
flavors to change over time. Automatic flavor matching will trigger a
new matching action when a new flavor is added, when an existing flavor
is deleted, or when a host is initially attested as Untrusted. The
system will automatically attempt to find a new set of flavors that
match the Flavor Group rules that will attest the host as Trusted. For
example, if a host in your datacenter has recently had a BIOS update,
the next attestation will cause the host to appear Untrusted (because
the <code>PLATFORM</code> measurements will now differ). Using automatic flavor
matching, the Verification Service will automatically search for a new
<code>PLATFORM</code> flavor that matches the actual BIOS version and measurement
seen on the host. If a new BIOS version is successfully found, the
Verification Service will use the new version for attestation, and the
host will appear Trusted. If no matching <code>PLATFORM</code> flavor is found, the
host will appear Untrusted. When automatic flavor matching is used,
think of the various flavors in the Verification Service as a collection
of valid configurations, and an attested host matching any combination
of those configurations (within the confines of the Flavor Group
requirements for which flavor types must be present) will be attested as
Trusted.</p>
<p>Host-based flavor matching explicitly maps a specific host to a flavor.
Host-based attestation requires that a host saves its entire
configuration in a composite flavor document in the system, and then
later validates against this flavor to detect any changes. In this case,
if a host received a BIOS upgrade, the host will attest as Untrusted,
and no attempt will be made to re-match a new flavor. An administrator
will need to explicitly specify a new flavor to be used for that host.</p>
<h3 id="when-does-flavor-matching-happen">When Does Flavor Matching Happen?</h3>
<p>Generally speaking, a new Flavor match operation is triggered whenever a
host is registered, whenever a host is attested and would be untrusted,
and whenever a Flavor is added to or removed from a Flavor group.</p>
<p>When a new host is registered, the Verification Service will retrieve
the Host Report and derive the platform information needed for Flavor
matching (BIOS version, server OEM, OS type and version, TPM version,
etc.). The Verification Service then searches through the Flavors in the
same Flavor group that the host is in, and finds any Flavors that match
the platform information.</p>
<p>If a Flavor is deleted, the Verification Service finds any hosts that
are currently associated with that Flavor, and attempts to match them to
alternative Flavors.</p>
<p>If a Flavor is added, the Verification Service looks for any hosts in
the same Flavor group that are not currently matched to a Flavor of the
appropriate Flavor part, and checks to see whether those hosts should be
mapped to the new Flavor.</p>
<p>If a new Report is generated for a host and would not result in a
Trusted attestation, the Verification Service will first repeat the
Flavor matching process to be sure that no matching Flavors exist in the
host’s Flavor group that would result in a Trusted attestation. If the
Service still finds no matching Flavors, the host will appear as
Untrusted.</p>
<h3 id="flavor-matching-performance">Flavor Matching Performance</h3>
<p>Flavor matching causes affected hosts to be moved into the <code>QUEUE</code> state
while the host and Flavor are evaluated to determine whether the host
and Flavor should be linked. Hosts can remain in the QUEUE state for
varying amounts of time based on the extent of the Flavor match
required. This means that the trust status of a host will not be
actually updated to reflect a new Flavor until after the process
finishes, which may take a few seconds or minutes depending on the
number of registered hosts, Flavors in the same Flavorgroup, etc.</p>
<p>If a new host is registered, only that host will be added to the queue,
and other hosts will be unaffected. The Verification Service will look
for only the <code>HOST\_UNIQUE</code> flavor part applicable to that specific host,
and then will look at all PLATFORM and OS Flavors in the same
Flavorgroup has the host, using the Flavor metadata and host info to
narrow the results. The Service will match the new host to the most
similar Flavors, and then move the host to the <code>CONNECTED</code> state and
generate a new trust report.</p>
<p>When a new PLATFORM or OS Flavor is created, the Service will instead
add all hosts in the same Flavorgroup as the new Flavors to the queue.
Each host in the queue will then be re-evaluated against every <code>PLATFORM</code> and <code>OS</code> Flavor in the Flavorgroup to determine the closest match.</p>
<p>This means that adding a new Flavor can cause more hosts to each spend
more time in the QUEUE state, as compared to adding a new host. For this
reason, as a best practice for initial population of Flavors and hosts
for a new deployment, it is suggested that Flavors be created before
registering hosts. This is not a concern after the initial population of
Flavors and hosts.</p>
<h3 id="flavor-groups">Flavor Groups</h3>
<p>Flavor Groups represent a collection of one or more Flavors that are
possible matches for a collection of one or more hosts. Flavor Groups
link to both Flavors and hosts – a host in Flavor Group "ABC" will only
be matched to Flavors in Flavor Group "ABC"</p>
<h3 id="default-flavor-group">Default Flavor Group</h3>
<p>By default the Verification Service includes a Flavor Group named
<code>automatic</code> and another named <code>unique</code> During host registration, the
<code>automatic</code> Flavor Group is used as a default selection if no other
Flavor Group is specified.</p>
<h4 id="automatic">automatic</h4>
<p>The automatic Flavor Group is used as the default Flavor Group for all
hosts and all Flavor parts. If no other Flavor Groups are specified when
creating Flavors or Hosts, all Hosts and Flavors will be added to this
group. This is useful for datacenters that want to manage a single set
of acceptable configurations for all hosts.</p>
<h4 id="unique">unique</h4>
<p>The unique Flavor Group is used to contain <code>HOST\_UNIQUE</code> Flavors. This
Flavorgroup is used by the backend software and should not be managed
manually.</p>
<h3 id="flavor-match-policies">Flavor Match Policies</h3>
<p>Flavor Match Policies are used to define how the Flavor Match engine
will match Flavors to hosts for attestation for a given Flavor Group.
Each Flavor part can have defined Flavor Match Policies within a given
Flavor Group.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;PLATFORM&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;any_of&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;required&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;OS&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;all_of&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;required_if_defined&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;HOST_UNIQUE&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;latest&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;required_if_defined&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;ASSET_TAG&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;latest&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;required_if_defined&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;IMA&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;all_of&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;required_if_defined&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>The sample Policy above would require that a <code>PLATFORM</code> Flavor part be
matched, but any <code>PLATFORM</code> Flavor part in the Flavor Group may be
matched. The <code>OS</code> Flavor Part will only be required if there is an <code>OS</code> Flavor part in the Flavor Group; if there are no <code>OS</code> Flavor parts in the
Group, the match will not be required. If more than one <code>OS</code> Flavor part
exists in the Group, all of those <code>OS</code> parts will be required to match for
a host to be Trusted.</p>
<h4 id="default-flavor-match-policy">Default Flavor Match Policy</h4>
<p>The <code>automatic</code> Flavor Group, and any Flavor Group created without
explicitly defining a Flavor Match Policy, will be created using the
following Flavor Match Policy. This is the default behavior for Flavor
Matching:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;PLATFORM&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;any_of&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;required&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;OS&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;any_of&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;required&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;HOST_UNIQUE&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;latest&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;required_if_defined&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;ASSET_TAG&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;latest&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;required_if_defined&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;IMA&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;all_of&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;required_if_defined&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h4 id="any_of">ANY_OF</h4>
<p>The <code>ANY_OF</code> Policy allows any Flavor of the specified Flavor part to be
matched. If the Flavor Group contains OS Flavor 1 and OS Flavor 2, a
host will be Trusted if it matches either OS Flavor 1 or OS Flavor 2.</p>
<h4 id="all_of">ALL_OF</h4>
<p>The <code>ALL_OF</code> Policy requires all Flavors of the specified Flavor Part in
the Flavor Group to be matched. For example, if Flavor Group X contains
PLATFORM Flavor Part 1 and <code>PLATFORM</code> Flavor Part 2, a host in Flavor
Group X will need to match both <code>PLATFORM</code> Flavor 1 and <code>PLATFORM</code> Flavor 2
to attest as Trusted. If the host matches only one of the Flavors, or
neither of them, the host will be attested as Untrusted.</p>
<h4 id="latest">LATEST</h4>
<p>The <code>LATEST</code> Policy requires that the most recently created Flavor of the
specified Flavor part be used when matching to a host. For example:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&quot;ASSET_TAG&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="s2">&quot;latest&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="s2">&quot;required_if_defined&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p><code>ASSET_TAG</code> Flavor parts by default use the above Policy. This means that
if Asset Tag Flavors are in the Flavor Group, the most recently created
Asset Tag Flavor will be used. If no Asset Tag Flavors are present in
the Flavor Group, then this Flavor part will be ignored.</p>
<h4 id="required">REQUIRED</h4>
<p>The <code>REQUIRED</code> Policy requires a Flavor of the specified part to be
matched. For example:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&quot;PLATFORM&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="s2">&quot;any_of&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="s2">&quot;required&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>This policy means that a <code>PLATFORM</code> Flavor part must be used; if the
Flavor Group contains no <code>PLATFORM</code> Flavor parts, hosts in this Flavor
Group will always count as Untrusted.</p>
<h4 id="required_if_defined">REQUIRED_IF_DEFINED</h4>
<p>The <code>REQUIRED_IF_DEFINED</code> Policy requires that a Flavor part be used if
a Flavor of that part exists. If no Flavor part of this type exists in
the Flavor Group, the Flavor part will not be required.</p>
<div class="highlight"><pre><span></span><code><span class="nt">&quot;ASSET_TAG&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="s2">&quot;latest&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="s2">&quot;required_if_defined&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p><code>ASSET_TAG</code> Flavor parts by default use the above Policy. This means that
if Asset Tag Flavors are in the Flavor Group, the most recently created
Asset Tag Flavor will be used. If no Asset Tag Flavors are present in
the Flavor Group, then this Flavor part will be ignored.</p>
<h3 id="flavor-match-event-triggers">Flavor Match Event Triggers</h3>
<p>Several events will cause the background queue service to attempt to
re-match Flavors and hosts:</p>
<ol>
<li>
<p>Host registration</p>
<p>This event is the first time a host will be attempted to be matched to
appropriate Flavors in the same Flavor Group, and affects only the host
that was added (other hosts will not be re-matched to Flavors when you
add a new host).</p>
</li>
<li>
<p>Flavor creation</p>
<p>When a new Flavor is added to a Flavor Group, the queue system will
repeat the Flavor match operation for all hosts in the same Flavor Group
as the new Flavor.</p>
</li>
<li>
<p>Flavor deletion</p>
<p>When a Flavor is deleted, the queue system will repeat the Flavor match
operation for all hosts in the same Flavor Group as the deleted Flavor.</p>
</li>
<li>
<p>Creation of a new Attestation Report</p>
<p>When a new Attestation Report is generated, if the host would attest as
Untrusted with the currently-matched Flavors, the host being attested
will be re-matched as part of the Report generation process. This
ensures that Reports are always generated using the best possible Flavor
matches available in the database.</p>
</li>
</ol>
<h3 id="sample-flavorgroup-api-calls">Sample Flavorgroup API Calls</h3>
<h4 id="create-a-new-flavorgroup">Create a New Flavorgroup</h4>
<div class="highlight"><pre><span></span><code>POST https://&lt;Verification Service IP or Hostname&gt;:8443/hvs/v2/flavorgroups
Authorization: Bearer &lt;token&gt;

{
    &quot;name&quot;: &quot;firstTest&quot;,
    &quot;flavor_match_policy_collection&quot;: {
        &quot;flavor_match_policies&quot;: [
            {
                &quot;flavor_part&quot;: &quot; PLATFORM&quot;,
                &quot;match_policy&quot;: {
                    &quot;match_type&quot;: &quot;ANY_OF&quot;,
                    &quot;required&quot;: &quot;REQUIRED&quot;
                }
            }
        ]
    }
}
</code></pre></div>
<p>Response:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;a0950923-596b-41f7-b9ad-09f525929ba1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;firstTest&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;flavor_match_policy_collection&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;flavor_match_policies&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;flavor_part&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot; PLATFORM&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;match_policy&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;match_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ANY_OF&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;REQUIRED&quot;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h2 id="ima-flavor">IMA Flavor</h2>
<p>IMA flavor will be generated with the ima measurements present in the host manifest and this flavor can be created multiple times based on the request. IMA flavor will be associated with the host based on ALL_OF match type policy. This will be supported by the existing API call itself.</p>
<p>POST : https://{{hvs_ip}}:30443/hvs/v2/flavors</p>
<p>Body
<div class="highlight"><pre><span></span><code>{
  &quot;connection_string&quot;:  &quot;https://&lt;host-ip&gt;:31443;&quot;,
  &quot;partial_flavor_types&quot;: [&quot;PLATFORM&quot;,&quot;OS&quot;,&quot;HOST_UNIQUE&quot;,&quot;IMA&quot;,&quot;SOFTWARE&quot;],
  &quot;flavorgroup_names&quot;: []
}
</code></pre></div></p>
<p>IMA flavor will be created based on the IMA Flavor template. This flavor will be stored in a flavors DB like other existing flavors.</p>
<h1 id="ima-flavor-template">IMA Flavor template</h1>
<div class="highlight"><pre><span></span><code>  {  
      &quot;label&quot;: &quot;ima&quot;,  
      &quot;condition&quot; :[
          &quot;//host_info/os_name//*[text()=&#39;RedHatEnterprise&#39;] or //host_info/os_name//*[text()=&#39;Centos&#39;] or //host_info/os_name//*[text()=&#39;Ubuntu&#39;]&quot;
      ], 
      &quot;flavor_parts&quot;: {  
          &quot;IMA&quot;: {  
              &quot;pcr_rules&quot;: [{  
                  &quot;pcr&quot;: {  
                      &quot;index&quot;: 10,  
                      &quot;bank&quot;: [&quot;SHA384&quot;, &quot;SHA256&quot;, &quot;SHA1&quot;]  
                  },  
                  &quot;pcr_matches&quot;: true  
              }]  
          }  
      }  
  }  
</code></pre></div>
<h1 id="sample-for-ima-flavor">Sample for IMA Flavor</h1>
<pre><code>```
{  
"flavor":{  
    "meta":{  
    "id":"2c3bcb9d-b140-4732-8a12-0af281246fe8",  
    "description":{  
        "digest_algorithm":"SHA256",  
        "flavor_part":"IMA",  
        "label":"ima"  
    },  
    "vendor":"INTEL"  
    },    
    "pcrs": [{    
                "pcr": {
        "index": 10,
        "bank":"SHA256"
                }, 
    "measurement": "3f95ecbb0bb8e66e54d3f9e4dbae8fe57fed96f0",
    "pcr_matches":true
        }],  
    "ima_measurements":[{  
        "file":"/root/test",  
        "measurement":"12aacb9f9da0518937f3da6c0526b381787faa60a65b319208391f303b5fe7b7a"  
    },  
    {  
        "file":"/usr/share/vim/vim80/ftplugin/yamlfile.vim",  
        "measurement":"a0ca2d70982bf2db5a71a59ca7afd90aed7041ae703e2e711847c98aff0ac800"  
    }]    
}  
}    
```
</code></pre>
<p>As with other Flavor parts, hosts will be matched to Flavors in the same
Flavorgroup that the host is added to, and will not be matched to
Flavors in different Flavorgroups. Flavor matching will happen on the
same events as for other Flavor parts.</p>
<h1 id="ima-integrity-rule">Ima-Integrity rule</h1>
<p>Current IMA logs will be taken from the hostmanifest file and the replay will be performed for all the IMA logs against the pcr10 cumulative hash recieved from the host.</p>
<h1 id="imaeventlogequals-rule">ImaEventLogEquals rule</h1>
<p>IMA flavor will be compared against the host manifest data of ima-log. If it matches, then it will store ima-trust status as true.</p>
<h1 id="attestation-report-generation">Attestation report generation</h1>
<ul>
<li>
<p>If the ima eventlog equals rule is true for all the measurements, we will provide only one entry in the report like below,
    <div class="highlight"><pre><span></span><code>&quot;IMA&quot;: {
    &quot;trust&quot;: true,
    &quot;rules&quot;: [{
        &quot;rule&quot;: {
            &quot;rule_name&quot;: &quot;rule.ImaEventLogEquals&quot;,
            &quot;markers&quot;: [
                &quot;IMA&quot;
            ]
        },
        &quot;flavor_id&quot;: &quot;253e5fc3-11b0-4a38-a2a0-4a264aa40139&quot;,
        &quot;trusted&quot;: true
    }]
}  
</code></pre></div></p>
</li>
<li>
<p>If ima eventlog equals rule fails for any of the ima measurements, we will log those entries under faults in the reports as below.
    <div class="highlight"><pre><span></span><code>&quot;IMA&quot;: {
    &quot;trust&quot;: false,
    &quot;rules&quot;: [{
        &quot;rule&quot;: {
            &quot;rule_name&quot;: &quot;rule.ImaEventLogEquals&quot;,
            &quot;markers&quot;: [
                &quot;IMA&quot;
            ]
        },
        &quot;flavor_id&quot;: &quot;253e5fc3-11b0-4a38-a2a0-4a264aa40139&quot;,
        &quot;faults&quot;: [{
            &quot;fault_name&quot;: &quot;fault.PcrValueMismatch&quot;,
            &quot;description&quot;: &quot;Host IMA log /usr/lib/systemd/libsystemd-shared-239.so with value 122e981e1d16de3269667f4e84bf8532462214f4f8a183e1c441bbfd3caecd10 does not match expected value 762e981e1d16de3269667f4e84bf84a0a0c84f4f8a183e13ac5ba1c441bbfd3c&quot;,
            &quot;pcr_index&quot;: &quot;10&quot;,
            &quot;pcr_bank&quot;: &quot;SHA256&quot;,
        }],
        &quot;trusted&quot;: false
    }]
}
</code></pre></div></p>
</li>
<li>
<p>If Hostmanifest contains unexpected/additional IMA log entries when compare to flavor measurements, PcrEventLogContainsUnexpectedEntries fault will be raised.
    <div class="highlight"><pre><span></span><code>&quot;IMA&quot;: {
    &quot;trust&quot;: false,
    &quot;rules&quot;: [{
        &quot;rule&quot;: {
            &quot;rule_name&quot;: &quot;rule.ImaEventLogEquals&quot;,
            &quot;markers&quot;: [
                &quot;IMA&quot;
            ]
        },
        &quot;flavor_id&quot;: &quot;253e5fc3-11b0-4a38-a2a0-4a264aa40139&quot;,
        &quot;faults&quot;: [{
            &quot;fault_name&quot;: &quot;fault.PcrEventLogContainsUnexpectedEntries&quot;,
            &quot;description&quot;: &quot;Module manifest for PCR 10 of SHA256 value contains 1 unexpected entries&quot;,
            &quot;unexpected_ima_entries&quot;: {
                &quot;pcr&quot;: {
                    &quot;index&quot;: 10,
                    &quot;bank&quot;: &quot;SHA256&quot;
                },
                &quot;ima_measurements&quot;: [
                    {
                        &quot;file&quot;: &quot;/root/ima-cont-test/check1.txt&quot;,
                        &quot;measurement&quot;: &quot;73b5b283c458f698b3eafc6afbb01149dec48c541896bce2a74d79a0881d7864&quot;
                    }
                ],
                &quot;ima_template&quot;: &quot;ima-ng&quot;
            }
        }],
        &quot;trusted&quot;: false
    }]
}
</code></pre></div></p>
</li>
<li>
<p>If hostmanifest does not contain all the measurements from flavor, PcrEventLogMissingExpectedEntries fault will be raised in the report.</p>
<div class="highlight"><pre><span></span><code>&quot;IMA&quot;: {
    &quot;trust&quot;: false,
    &quot;rules&quot;: [{
        &quot;rule&quot;: {
            &quot;rule_name&quot;: &quot;rule.ImaEventLogEquals&quot;,
            &quot;markers&quot;: [
                &quot;IMA&quot;
            ]
        },
        &quot;flavor_id&quot;: &quot;253e5fc3-11b0-4a38-a2a0-4a264aa40139&quot;,
        &quot;faults&quot;: [{
            &quot;fault_name&quot;: &quot;fault.PcrEventLogMissingExpectedEntries&quot;,
            &quot;description&quot;: &quot;Module manifest for PCR 10 of SHA256 value missing 2 expected entries&quot;,
            &quot;unexpected_ima_entries&quot;: {
                &quot;pcr&quot;: {
                    &quot;index&quot;: 10,
                    &quot;bank&quot;: &quot;SHA256&quot;
                },
                &quot;ima_measurements&quot;: [
                    {
                        &quot;file&quot;: &quot;/root/itest.txt&quot;,
                        &quot;measurement&quot;: &quot;73b5b283c458f698b3eafc6afbb01149dec48c541896bce2a74d79a0881d7864&quot;
                    },
                    {
                        &quot;file&quot;: &quot;/root/icheck.txt&quot;,
                        &quot;measurement&quot;: &quot;fbf99c21c97b5134c22430e6bdd5f35a44e6d3a14855f13a8fdcce84eb52994a&quot;
                    }
                ],
                &quot;ima_template&quot;: &quot;ima-ng&quot;
            }
        }],
        &quot;trusted&quot;: false
    }]
}
</code></pre></div>
</li>
</ul>
<h1 id="sample-for-ima-measurement-log-integrity-rule-in-report">Sample for IMA measurement log integrity rule in report,</h1>
<pre><code>```
"IMA": {
"trust": true,
"rules": [{
    "rule": {
        "rule_name": "rule.ImaMeasurementLogIntegrity",
        "markers": [
            "IMA"
        ],
        "expected_pcr": {
            "pcr": {
                "index": 10,
                "bank": "SHA256"
            },
            "measurement": "b6e1251e1d16de3269667f4e84bf84a0a0c84f4f8a183e13ac5ba1c441bbfd3c",
            "pcr_matches": true
        },
        "expected_imavalues": {
            "ima_measurements": [
                {
                    "file": "boot_aggregate",
                    "measurement": "cacb533ca55a87d4e0c5954608102091ab42b99ae8fbbdbba7c93efad5e6a174"
                },
                {
                    "file": "/root/ima-cont-test/check1.txt",
                    "measurement": "b351e6014c0713eda511289d7af11a3c49f7162b471fb93adca869f37d6d4d15"
                },
                {
                    "file": "/root/ima-cont-test/check2.txt",
                    "measurement": "fc1ebc0a83cdea7e2e63063c81f935319207194b4425d3a88fd1f9c8de1184b7"
                }
            ]
        }
    },
    "flavor_id": "12835fc3-11b0-4a38-a2a0-4a264aa40139",
    "trusted": true
}]
}
```
</code></pre>
<p>As part of tpm quote response, TA will send ima_log.</p>
<p>To include the ima logs in the tpm quote response, the following cofiguration parameters will be added by hvs in the tpm-quote request body.</p>
<pre><code>```    
`ima_measure_enabled` - it can be true or false under TA `config.yaml` located in `/etc/trustagent/v5.0.0/`. Only if it is true, 
IMA logs will be sent by TA.
```
</code></pre>
<hr />
<p><strong>NOTE</strong>: 
IMA logs will be sent only when the ima enable option is set in the tpm quote request body and the same configuration is enabled in the TA as well.</p>
<hr />





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../70%20Workload%20Confidentiality/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Workload Confidentiality" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Workload Confidentiality
            </div>
          </div>
        </a>
      
      
        
        <a href="../100%20Scalability%20and%20Sizing/" class="md-footer__link md-footer__link--next" aria-label="Next: Scalability and Sizing" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Scalability and Sizing
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.instant", "navigation.indexes", "navigation.top", "search.suggest"], "search": "../../../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.37e9125f.min.js"></script>
      
    
  </body>
</html>